#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/ioctl.h>
#include <fcntl.h>
#include "myBigChars.h"
#include "Enum.h"
#include <string.h>

#define FONT_FILE "./font.bin"
#define FONT_WIDTH 8
#define FONT_HEIGHT 8
#define NUM_SYMBOLS 18

unsigned char font[18][FONT_HEIGHT] = 
{
    {0x3C, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x3C}, // 0
    {0x0E, 0x3E, 0x7E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E}, // 1
    {0x7E, 0x7E, 0x0E, 0x7E, 0x7E, 0x70, 0x7E, 0x7E}, // 2
    {0x3C, 0x66, 0x06, 0x1C, 0x1E, 0x06, 0x66, 0x3C}, // 3
    {0x66, 0x66, 0x66, 0x66, 0x7E, 0x7E, 0x06, 0x06}, // 4
    {0x7E, 0x40, 0x40, 0x7E, 0x02, 0x02, 0x02, 0x7E}, // 5
    {0x7E, 0x7E, 0x60, 0x7E, 0x66, 0x66, 0x7E, 0x7E}, // 6
    {0x7E, 0x06, 0x04, 0x1C, 0x18, 0x18, 0x18, 0x18}, // 7
    {0x3C, 0x66, 0x66, 0x3C, 0x66, 0x66, 0x66, 0x3C}, // 8
    {0x7E, 0x7E, 0x66, 0x66, 0x7E, 0x06, 0x7E, 0x7E}, // 9
    {0x18, 0x3C, 0x24, 0x66, 0x7E, 0x7E, 0x66, 0x66}, // A
    {0x7C, 0x66, 0x66, 0x7C, 0x66, 0x66, 0x66, 0x7C}, // B
    {0x3C, 0x7E, 0x66, 0x60, 0x60, 0x66, 0x7E, 0x3C}, // C
    {0x7C, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x7C}, // D
    {0x7E, 0x7E, 0x60, 0x7E, 0x7E, 0x60, 0x7E, 0x7E}, // E
    {0x7E, 0x7E, 0x60, 0x7E, 0x7E, 0x60, 0x60, 0x60}, // F
    {0x00, 0x18, 0x18, 0x7E, 0x7E, 0x18, 0x18, 0x00}, // +
    {0x00, 0x00, 0x00, 0x7E, 0x7E, 0x00, 0x00, 0x00}  // -
};

int save_font(const char *filename) 
{
    int fd = open(filename, O_WRONLY | O_CREAT | O_TRUNC, 0666);
    if (fd == -1) 
    {
        return -1;
    }

    for (int i = 0; i < NUM_SYMBOLS; i++) 
    {
        if (write(fd, font[i], FONT_HEIGHT) != FONT_HEIGHT) 
        {
            close(fd);
            return -1;
        }
    }

    close(fd);
    return 0;
}

int main(int argc, char *argv[]) 
{
    if (access(FONT_FILE, F_OK) == -1) 
    {
        if (save_font(FONT_FILE) == -1) 
        {
            return -1;
        }
    }

    return 0;
}
